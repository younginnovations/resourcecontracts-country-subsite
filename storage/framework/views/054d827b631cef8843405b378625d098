<?php
$api = app('App\Http\Services\APIService');
$summary = $api->sortSummaryCountry();
$attributes = $api->searchAttributed();
$category = $api->getAnnotationsCategory();
?>
<form action="<?php echo e(url('search')); ?>" method="get" class="search-form <?php if(isset($show_advance)): ?> search-page-form <?php endif; ?>" id="search-form">
    <div class="form-group">
        <button type="submit" class="btn btn-navbar-search pull-left"></button>
        <input  type="text" autocomplete="off" value="<?php echo e(\Illuminate\Support\Facades\Input::get('q')); ?>" name="q" id="query"  class="form-control pull-left" placeholder="<?php echo app('translator')->get('search.search_placeholder'); ?>">
    </div>
    <div class="search-input-wrapper <?php if(isset($show_advance)): ?> search-page-input-wrapper <?php endif; ?>">
        <div class="col-lg-12">
            <div class="col-xs-6 col-sm-3 col-md-3 col-lg-2 input-wrapper">
                <label for=""><?php echo app('translator')->get('search.year_signed'); ?></label>
                <select name="year[]" id="year" multiple="multiple">
                    <?php foreach($summary->year_summary as $year): ?>
                        <option <?php if(isset($filter['year']) && in_array($year->key, $filter['year'])): ?> selected="selected" <?php endif; ?> value="<?php echo e($year->key); ?>"><?php echo e($year->key); ?></option>
                    <?php endforeach; ?>
                </select>
            </div>

            <div class="col-xs-6 col-sm-3 col-md-3 col-lg-2 input-wrapper">
                <label for=""><?php echo app('translator')->get('global.resource'); ?></label>
                <select name="resource[]" id="resource" multiple="multiple">
                    <?php foreach($summary->resource_summary as $resource): ?>
                        <option <?php if(isset($filter['resource']) && in_array($resource->key, $filter['resource'])): ?>selected="selected" <?php endif; ?> value="<?php echo e($resource->key); ?>"><?php echo e($resource->key); ?></option>
                    <?php endforeach; ?>
                </select>
            </div>
            <div class="col-xs-6 col-sm-3 col-md-3 col-lg-2 input-wrapper">
                <label for=""><?php echo app('translator')->get('search.company_name'); ?></label>
                <select name="company_name[]" id="company" multiple="multiple">
                    <?php $company_array = array_map('trim', (array) $attributes->company_name);
                    sort($company_array);
                    ?>
                    <?php foreach($company_array as $company): ?>
                        <option <?php if(isset($filter['company_name']) && in_array($company, $filter['company_name'])): ?> selected="selected" <?php endif; ?> value="<?php echo e($company); ?>"><?php echo e($company); ?></option>
                    <?php endforeach; ?>
                </select>
            </div>
        </div>
        <div class="col-lg-12">
            <?php if(env('CATEGORY')=="rc"): ?>
                <div class="col-xs-6 col-sm-3 col-md-3 col-lg-2 input-wrapper">
                    <label for=""><?php echo app('translator')->get('search.corporate_group'); ?></label>
                    <select name="corporate_group[]" id="corporate_group" multiple="multiple">
                        <?php foreach($attributes->corporate_grouping as $group): ?>
                            <option <?php if(isset($filter['corporate_group']) && in_array($group, $filter['corporate_group'])): ?> selected="selected" <?php endif; ?> value="<?php echo e($group); ?>"><?php echo e($group); ?></option>
                        <?php endforeach; ?>
                    </select>
                </div>
            <?php endif; ?>
            <div class="col-xs-6 col-sm-3 col-md-3 col-lg-2 input-wrapper">
                <label for=""><?php echo app('translator')->get('search.contract_type'); ?></label>
                <select name="contract_type[]" id="contract_type" multiple="multiple">
                    <?php foreach(array_filter($attributes->contract_type) as $type): ?>
                        <option <?php if(isset($filter['contract_type']) && in_array($type, $filter['contract_type'])): ?> selected="selected" <?php endif; ?> value="<?php echo e($type); ?>"><?php echo e($type); ?></option>
                    <?php endforeach; ?>
                </select>
            </div>
            <div class="col-xs-6 col-sm-3 col-md-3 col-lg-2 input-wrapper">
                <label for=""><?php echo app('translator')->get('search.annotations_category'); ?></label>
                <?php $annotation_category = array_map('trim', (array) $category->results);
                sort($annotation_category);
                ?>
                <select name="annotation_category[]" id="annotation_category" multiple="multiple">
                    <?php foreach(array_filter($annotation_category) as $cat): ?>
                        <option <?php if(isset($filter['annotation_category']) && in_array($cat, $filter['annotation_category'])): ?> selected="selected" <?php endif; ?> value="<?php echo e($cat); ?>"><?php echo e($cat); ?></option>
                    <?php endforeach; ?>
                </select>
            </div>
        </div>
        <div class="col-lg-12">
            <div class="col-xs-6 col-sm-3 col-md-3 col-lg-2">
                <button type="submit" class="btn btn-form-search"><?php echo app('translator')->get('global.search'); ?></button>
            </div>
            <div class="col-xs-6 col-sm-3 col-md-3 col-lg-2">
                <button type="reset" name="reset"  id="searchclear" class="btn btn-form-search btn-form-reset">Reset</button>
            </div>
            <?php if(!isset($searchPage)): ?>
                <div class="col-xs-6 col-sm-3 col-md-3 col-lg-2">
                    <button type="submit" class="btn btn-form-search search-close"><?php echo app('translator')->get('global.cancel'); ?></button>
                </div>
            <?php endif; ?>
        </div>
    </div>
    <script>
        var lang = <?php echo json_encode(trans('annotation'));?>;
    </script>
</form>